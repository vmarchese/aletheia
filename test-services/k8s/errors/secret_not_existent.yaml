apiVersion: v1
kind: Pod
metadata:
  name: pod-with-missing-secret
  namespace: aletheia-test
  labels:
    app: test-pod
    scenario: secret-mount-error
    error-type: missing-secret
spec:
  containers:
  - name: app-container
    image: registry.localhost:5000/aletheia/golang-test-service:latest-arm64
    imagePullPolicy: IfNotPresent
    ports:
    - name: http
      containerPort: 8080
      protocol: TCP
    env:
    - name: SECRET_PATH
      value: "/etc/secrets"
    volumeMounts:
    - name: secret-volume
      mountPath: /etc/secrets
      readOnly: true
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      allowPrivilegeEscalation: false
  volumes:
  - name: secret-volume
    secret:
      secretName: non-existent-secret
      optional: false
  restartPolicy: Never
